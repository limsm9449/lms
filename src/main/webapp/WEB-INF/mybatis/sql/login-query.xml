<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="login">
	
    <select id="getLoginUser" resultType="com.qp.lms.login.model.LoginVO">
    	SELECT 	USER_ID, 
				USER_NAME, 
				IFNULL(ADMIN_YN,'N') ADMIN_YN, 
				IFNULL(SITE_MANAGER_YN,'N') SITE_MANAGER_YN, 
				IFNULL(CONTENTS_MANAGER_YN,'N') CONTENTS_MANAGER_YN, 
				IFNULL(TUTOR_YN,'N') TUTOR_YN, 
				IFNULL(TEACHER_YN,'N') TEACHER_YN, 
				EMAIL, 
				BIRTH_DAY, 
				SEX, 
				USER_PASSWORD, 
				HOME_ZIPCODE, 
				HOME_ADDR, 
				HOME_TEL, 
				MOBILE, 
				JOB, 
				COMP_CD, 
				RETIRED_YN, 
				RETIRED_REASON, 
				BANK, 
				ACC_NUM, 
				IFNULL(CERTIFICATION_YN,'N') CERTIFICATION_YN, 
				CERTIFICATION_KEY, 
				CAREER,
				(SELECT COMP_NAME FROM COMPANY WHERE COMP_CD = A.COMP_CD) COMP_NAME 	 
    	  FROM 	USER A
    	 WHERE 	USER_ID = #{userId}
    	   AND 	USER_PASSWORD = PASSWORD(#{password}) 
    </select>

    <select id="isExistUser" resultType="com.qp.lms.login.model.LoginVO">
    	SELECT COUNT(*) CNT
    	  FROM USER
    	 WHERE USER_ID = #{userId}
    </select>

    <select id="getUserInfo" resultType="com.qp.lms.login.model.LoginVO">
    	SELECT 	USER_ID, 
				USER_NAME, 
				IFNULL(ADMIN_YN,'N') ADMIN_YN, 
				IFNULL(SITE_MANAGER_YN,'N') SITE_MANAGER_YN, 
				IFNULL(CONTENTS_MANAGER_YN,'N') CONTENTS_MANAGER_YN, 
				IFNULL(TUTOR_YN,'N') TUTOR_YN, 
				IFNULL(TEACHER_YN,'N') TEACHER_YN, 
				EMAIL, 
				BIRTH_DAY, 
				SEX, 
				USER_PASSWORD, 
				HOME_ZIPCODE, 
				HOME_ADDR, 
				HOME_TEL, 
				MOBILE, 
				JOB, 
				COMP_CD, 
				RETIRED_YN, 
				RETIRED_REASON, 
				BANK, 
				ACC_NUM, 
				IFNULL(CERTIFICATION_YN,'N') CERTIFICATION_YN, 
				CERTIFICATION_KEY, 
				CAREER 
    	  FROM 	USER A
    	 WHERE 	USER_ID = #{userId}
    </select>
</mapper>